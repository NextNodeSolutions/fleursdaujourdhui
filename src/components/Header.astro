---
import { Flower2 } from 'lucide-react'

export interface Props {
	navItems?: Array<{ label: string; href: string }>
}

const {
	navItems = [
		{ label: 'Accueil', href: '/' },
		{ label: 'Mariages', href: '/mariages' },
		{ label: 'Événementiel', href: '/evenementiel' },
		{ label: 'Abonnements', href: '/abonnements' },
		{ label: 'Contact', href: '/contact' },
	],
} = Astro.props

const currentPath = Astro.url.pathname
---

<header
	class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"
	id="navbar"
>
	<nav class="container-padding mx-auto max-w-7xl">
		<div class="flex h-20 items-center justify-between">
			<!-- Logo -->
			<a href="/" class="group flex items-center gap-3 transition-all">
				<div
					class="flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-rose-500 to-rose-600 shadow-lg transition-transform duration-300 group-hover:scale-105 group-hover:rotate-3"
				>
					<Flower2 className="h-6 w-6 text-white" />
				</div>
				<div class="flex flex-col">
					<span class="font-serif text-xl font-bold leading-tight text-gray-900">
						Fleurs d'Aujourd'hui
					</span>
					<span class="text-xs font-medium text-sage-600">
						Fleuriste Artisan
					</span>
				</div>
			</a>

			<!-- Desktop Navigation -->
			<div class="hidden items-center gap-2 md:flex">
				{
					navItems.map(item => {
						const isActive = currentPath === item.href
						return (
							<a
								href={item.href}
								class={`
									relative px-4 py-2 font-medium transition-all duration-200
									${isActive
										? 'text-rose-600'
										: 'text-gray-700 hover:text-rose-600'
									}
									group
								`}
							>
								{item.label}
								<span
									class={`
										absolute bottom-0 left-0 h-0.5 w-full bg-gradient-to-r from-rose-500 to-rose-600 transition-all duration-300
										${isActive ? 'scale-x-100' : 'scale-x-0 group-hover:scale-x-100'}
									`}
								/>
							</a>
						)
					})
				}
			</div>

			<!-- CTA Button -->
			<div class="hidden md:block">
				<a
					href="/contact"
					class="group relative overflow-hidden rounded-lg bg-gradient-to-r from-rose-600 to-rose-500 px-6 py-3 font-medium text-white shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105"
				>
					<span class="relative z-10">Nous contacter</span>
					<div
						class="absolute inset-0 bg-gradient-to-r from-rose-700 to-rose-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100"
					>
					</div>
				</a>
			</div>

			<!-- Mobile menu button -->
			<button
				type="button"
				class="md:hidden relative h-10 w-10 rounded-lg border-2 border-gray-200 bg-white/80 backdrop-blur-sm transition-all hover:border-rose-300 focus:outline-none focus:ring-2 focus:ring-rose-500"
				id="mobile-menu-button"
				aria-label="Toggle menu"
			>
				<div class="absolute inset-0 flex flex-col items-center justify-center gap-1.5">
					<span
						class="h-0.5 w-5 bg-gray-700 transition-all duration-300"
						id="menu-line-1"></span>
					<span
						class="h-0.5 w-5 bg-gray-700 transition-all duration-300"
						id="menu-line-2"></span>
					<span
						class="h-0.5 w-5 bg-gray-700 transition-all duration-300"
						id="menu-line-3"></span>
				</div>
			</button>
		</div>

		<!-- Mobile menu -->
		<div
			class="md:hidden overflow-hidden transition-all duration-300 max-h-0 opacity-0"
			id="mobile-menu"
		>
			<div
				class="space-y-2 rounded-2xl border border-gray-200 bg-white/95 backdrop-blur-md px-4 py-6 mt-4 shadow-xl"
			>
				{
					navItems.map(item => {
						const isActive = currentPath === item.href
						return (
							<a
								href={item.href}
								class={`
									block rounded-lg px-4 py-3 font-medium transition-all duration-200
									${isActive
										? 'bg-rose-50 text-rose-600'
										: 'text-gray-700 hover:bg-gray-50 hover:text-rose-600'
									}
								`}
							>
								{item.label}
							</a>
						)
					})
				}
				<a
					href="/contact"
					class="mt-4 block w-full rounded-lg bg-gradient-to-r from-rose-600 to-rose-500 px-4 py-3 text-center font-medium text-white transition-all duration-200 hover:shadow-lg"
				>
					Nous contacter
				</a>
			</div>
		</div>
	</nav>
</header>

<script>
	const navbar = document.getElementById('navbar')
	const button = document.getElementById('mobile-menu-button')
	const menu = document.getElementById('mobile-menu')
	const line1 = document.getElementById('menu-line-1')
	const line2 = document.getElementById('menu-line-2')
	const line3 = document.getElementById('menu-line-3')

	let isMenuOpen = false

	button?.addEventListener('click', () => {
		isMenuOpen = !isMenuOpen

		if (isMenuOpen) {
			menu?.classList.remove('max-h-0', 'opacity-0')
			menu?.classList.add('max-h-96', 'opacity-100')
			line1?.classList.add('rotate-45', 'translate-y-2')
			line2?.classList.add('opacity-0')
			line3?.classList.add('-rotate-45', '-translate-y-2')
		} else {
			menu?.classList.add('max-h-0', 'opacity-0')
			menu?.classList.remove('max-h-96', 'opacity-100')
			line1?.classList.remove('rotate-45', 'translate-y-2')
			line2?.classList.remove('opacity-0')
			line3?.classList.remove('-rotate-45', '-translate-y-2')
		}
	})

	window.addEventListener('scroll', () => {
		const currentScroll = window.pageYOffset

		if (currentScroll > 50) {
			navbar?.classList.add('bg-white/80', 'backdrop-blur-lg', 'shadow-lg')
			navbar?.classList.remove('bg-transparent')
		} else {
			navbar?.classList.remove('bg-white/80', 'backdrop-blur-lg', 'shadow-lg')
			navbar?.classList.add('bg-transparent')
		}
	})

	window.addEventListener('resize', () => {
		if (window.innerWidth >= 768 && isMenuOpen) {
			isMenuOpen = false
			menu?.classList.add('max-h-0', 'opacity-0')
			menu?.classList.remove('max-h-96', 'opacity-100')
			line1?.classList.remove('rotate-45', 'translate-y-2')
			line2?.classList.remove('opacity-0')
			line3?.classList.remove('-rotate-45', '-translate-y-2')
		}
	})
</script>
